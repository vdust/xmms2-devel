.\"
.\" xmmsclient - The official XMMS2 client library
.\"
.\" xmms2-pattern.7 - Patterns syntax for XMMS2 collection parser
.\"
.\" Copyright (C) 2005-2011 XMMS2 Team
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer
.\"    in this position and unchanged.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.TH XMMS2-PATTERNS 7
.SH NAME
xmpattern - Patterns in the XMMS2 Collection Parser library.
.SH DESCRIPTION
.PP
This document discribes the syntax of patterns recognized by the XMMS2
Collection Parser library for coll 2.0
.SH PROPERTIES AND VALUES
.PP
Properties and values are used in filters expressions (see \fBFILTERS\fP
below).
.SS Properties
.PP
A property name can contain alpha-numeric characters, the dash character
(\fB-\fP), and the underscore character (\fB_\fP). The language provides
one-character aliases to common properties:
.PP
.PD 0
.RS
.TP
.B a
artist
.TP
.BR l " or " b
album
.TP
.B t
title
.TP
.B n
tracknr
.TP
.B y
year
.TP
.B g
genre
.TP
.B u
url
.RE
.PD
.PP
A property may contain other characters, in the condition they are escaped
with a backslash '\\' or quoted with double or single quotes.
.SS Values
.PP
A value can contain any character, except for special characters which must be
quoted in some cases:
.PP
.PD 0
.RS
.TP
\fBspaces\fP, \fB'\fP, \fB"\fP
Must always be quoted.
.TP
.BR AND ", " OR ", " NOT
Must be quoted only when they are the value and the value is used alone.
.TP
.BR ( ", " )
Must be quoted only if they appear at the beginning or at the end of the value.
.TP
.B filters
Must be quoted when the value is used alone.
.RE
.PD
.PP
The whole value or parts
of it can be quoted using single quotes (\fB'\fP) or double quotes (\fB"\fP).
If the value contains quotes, they must be quoted with quotes of the other type.
.PP
Some characters have a special meaning even when they appear inside quotes:
.PP
.PD 0
.RS
.TP
.B *
matches 0 or more characters when used with \fImatch\fP (\fB~\fP, \fB:\fP) or
\fItoken\fP (\fB^\fP) filters.
.TP
.B ?
matches any character with \fImatch\fP filters.
.RE
.PD
.SH OPERATORS
.PP
\fIexpr\fP represents any valid pattern. Operators with the highest priority
are listed first:
.PP
.PD 0
.TP
.BI "( " expr " )"
Match all media that match by \fIexpr\fP. Grouping allow to override the
priority of operators.
.TP
.BI "NOT " expr
Match all media that do not match \fIexpr\fP
.TP
.IB expr1 " AND " expr2
Match all media that match both \fIexpr1\fP and \fIexpr2\fP
.TP
.I expr1 expr2
Match all media that match both \fIexpr1\fP and \fIexpr2\fP
.TP
.IB expr1 " OR " expr2
Match all media that match either \fIexpr1\fP, \fIexpr2\fP or both
.PD
.SH "FILTERS"
.PP
In the following rules, when \fIprop\fP is omitted (if optional),
the value is matched on any property defined in a media.
.PP
.PD 0
.TP
.IB \fP[[\fIprop\fP]\fI :\fP]\fB value
Match all media of which the property \fIprop\fP is equal to \fIvalue\fP. If
\fIprop\fP is omitted, \fI:\fP can also be omitted.
.TP
.IB \fP[\fIprop\fP]\fI ~ value
Match all media of which the property \fIprop\fP contains \fIvalue\fP. This is
equivalent to \fIprop\fP\fB:\fP*\fIvalue\fP*
.TP
.IB \fP[\fIprop\fP]\fI ^ value\fP[\fI*\fP]\fI
Match all media of which the property \fIprop\fP contains the token \fIvalue\fP.
A token is always preceeded and followed by white spaces. A token can be ended
by \fI*\fP to match tokens that start with \fIvalue\fP. \fBWARNING\fP: Any
character after the first \fI*\fP is currently discarded.
.TP
.IB \fP[\fIprop\fP]\fI "<" value
Match all media of which the property \fIprop\fP is smaller than \fIvalue\fP.
.TP
.IB \fP[\fIprop\fP]\fI "<=" value
Match all media of which the property \fIprop\fP is smaller than or equal to
\fIvalue\fP
.TP
.IB \fP[\fIprop\fP]\fI ">" value
Match all media of which the property \fIprop\fP is greater than \fIvalue\fP
.TP
.IB \fP[\fIprop\fP]\fI ">=" value
Match all media of which the property \fIprop\fP is greater than or equal to
\fIvalue\fP
.TP
.BI in: \fIcoll\fP
Match all media that are in the collection \fIcoll\fP. \fBin:"All Media"\fP is
an alias to the Universe collection.
.TP
.BI *
When used alone (i.e. preceeded and followed by white spaces), \fI*\fP is an
alias to the Universe collection.
.TP
.BI + prop
Match all media which has the property \fIprop\fP
.TP
.BI # seq
Match media of which id appears in the sequence \fIseq\fP. A sequence is a
comma (\fB,\fP) separated list of ids and ranges. A range is of the form
\fIfirst\fP\fB-\fP\fIlast\fP
.PD
.SS Special case with the url property
.PP
When matching against the \fIurl\fP property, the value is expected to be
url-encoded, unless the fuzzy match operator (i.e. url\fB~\fPvalue) is
used, in which case the value is first encoded (including * and ? that lose
their glob meaning in this case).
.SH EXAMPLES
.PP
Match all media which are part of an album, except for the first tracks
.RS
.PP
\fB+\fPalbum \fBAND\fP \fBNOT\fP tracknr\fB:\fP1
.br
.in -3n
or
.in
.br
\fB+\fPa n\fB>\fP1
.RE
.sp
.PP
Match all media released before 1999 or after 2009 and which have the rating
property.
.RS
.PP
\fB+\fPrating \fBAND\fP \fB(\fP date\fB<\fP1999 \fBOR\fP date\fB>\fP2009 \fB)\fP
.RE
.sp
.PP
Match all media of which album, title or artist starts with "The " and album
contains the token "Best", except for media with ids 42, 84, 168 to 336 and 672.
.RS
.PP
\fB:\fP"The *" \fBAND\fP b\fB^\fPBest \fBAND\fP \fBNOT\fP \fB#\fP42,84,168-336,672
.RE
.sp
.PP
Match all media of which the url contains a directory starting by 'Best ' but
is not 'Best Of' (see how the second filter requires the space to be encoded
manually)
.RS
.PP
url\fB~\fP"/Best " \fBAND NOT\fP url\fB:\fP"*/Best+Of/*"
.RE
.SH "SEE ALSO"
.BR xmms2 (1)
.SH AUTHORS
Raphael Bois
.PP
See the
.B AUTHORS
file in the XMMS2 source distribution for more info.
